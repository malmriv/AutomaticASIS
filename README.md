# 🔍 Automatic AS-IS Iflow extractor

> **ℹ️ Important! Read this!**
>
> This repo contains Python scripts that can be run locally. Nevertheless, I have managed to package this as a web app so that it's easier for everyone to use. The web app can be found [here](https://integration-report.streamlit.app/), and I think it's come together quite nicely. The repo of the web app itself, which is what I will maintain in the future, can be found [here](https://github.com/malmriv/integration-suite-explorer).


This Python script extracts and documents integration flow metadata from zipped SAP Integration Suite packages. It support address resolution for various adapter types and automatically substitutes parameterized values (e.g., `{{c4c_address}}`) using the included `parameters.prop` file.

![Example of the script working and resulting file imported into Excel](https://github.com/malmriv/malmriv.github.io/blob/master/images/ScreenshotASIS.png?raw=true)

The script is able to process entire packages (which are also downloaded as .zip files). Bulk processing is also supported: the script will try to process any .zip files in the same folder.

---

## Features

- Automatically unzips multiple `.zip` files containing iflows  
- Locates and parses the `.iflw` file  
- Extracts metadata for each message flow:  
  - component type (e.g. SOAP, HTTPS, JMS, SFTP...)
  - direction  (Sender/Receiver)
  - name  
  - transport protocol (e.g. HTTPS, SFTP...)  
  - address (e.g. https://mycrm.company.com/api/v1)
- Supports parameter resolution using `parameters.prop`
- Flags whether a parameter was resolved (`parametrized` = true/false)
- Extracts iflow ID and version from MANIFEST.MF file
- Supports direction-aware address keys (e.g., JMS inbound/outbound)  

---

## Usage

In Windows:
1. Place the `.zip` file(s) containing your integration packages in the same directory as the desired Python script and the `RunExtractor.bat` batch file.
2. Run the `.bat` file.
3. The script will run and a comma-separated value (`.csv`) file will appear.
4. The temporary files generated by the script will be deleted afterwards.

More generally, without using the `.bat` file, the script can be run normally from the console. In that case (for example, under a Linux distribution, or in a macOS computer):
1. Place the `.zip` file(s) containing your iflow in the same directory as the script.
2. Navigate to that directory in a terminal (`cd (...)/dir`)
3. Run the script with Python 3 (`python AutomaticASIS.py`).  
4. The script will unzip the package, extract message flow data, resolve parameters, and save the output to `automatic_asis.csv`.  
---

## Output

The script generates a CSV file `automatic_asis.csv` with the following columns:

### Example output

| Package                                          | Iflow                                   | IflowID           | IflowVersion | AdapterType  | TransportProtocol | AdapterDirection | AdapterName                          | AdapterVersion | AdapterAddress             | IsParametrized |
|--------------------------------------------------|------------------------------------------|-------------------|--------------|---------------|--------------------|------------------|----------------------------------------|----------------|----------------------------|----------------|
| CRM Global Marketing and third-party Integrations | Emarsys metrics process callback         | ***               | 1.0.0        | ProcessDirect | Not Applicable     | Receiver         | ProcessDirect                          | 1.1            | ***                        | True           |
| CRM Global Marketing and third-party Integrations | Emarsys metrics process callback         | ***               | 1.0.0        | PollingSFTP   | SFTP               | Sender           | SFTP                                   | 1.7            |                            | False          |
| CRM Global Marketing and third-party Integrations | Emarsys metrics process callback         | ***               | 1.0.0        | HTTPS         | HTTPS              | Sender           | HTTPS                                  | 1.5            | ***                        | True           |
| CRM Global Marketing and third-party Integrations | ORBIS match                              | ***               | 1.0.0        | HTTPS         | HTTPS              | Sender           | HTTPS                                  | 1.4            | ***                        | False          |
| CRM Global Marketing and third-party Integrations | ORBIS match                              | ***               | 1.0.0        | HTTP          | HTTP               | Receiver         | HTTP                                   | 1.14           | ***                        | True           |
| CRM Global Marketing and third-party Integrations | KYC-KYM Receive delegation request       | ***               | 1.0.3        | JMS           | Not Applicable     | Receiver         | JMS_LOCAL                              | 1.6            | ***                        | True           |
| CRM Global Marketing and third-party Integrations | KYC-KYM Receive delegation request       | ***               | 1.0.3        | ProcessDirect | Not Applicable     | Sender           | ProcessDirect                          | 1.1            | ***                        | True           |
| CRM Global Marketing and third-party Integrations | KYC-KYM Receive delegation request       | ***               | 1.0.3        | HTTPS         | HTTPS              | Sender           | HTTPS                                  | 1.5            | ***                        | True           |
| CRM Global Marketing and third-party Integrations | C4C launch confirmation process BATCH    | ***               | 1.0.1        | ProcessDirect | Not Applicable     | Receiver         | ProcessDirect_launchConfirmationEmail | 1.1            | ***                        | False          |
| CRM Global Marketing and third-party Integrations | C4C launch confirmation process BATCH    | ***               | 1.0.1        | HTTPS         | HTTPS              | Sender           | HTTPS                                  | 1.5            | ***                        | True           |



---

## Parameter substitution

- Parameters are detected in the address using `{{param_name}}` syntax.  
- The script loads parameters from the `parameters.prop` file inside the unzipped folder.  
- If a parameter is found, it replaces it in the address and sets `parametrized` to true.  
- If a parameter is missing, it leaves the placeholder as is but still marks `parametrized` true.  

---

## Supported component types and address keys

The script supports common SAP CPI adapter component types. Each adapter type displays its connectivity-related info in a node with a specific name. The adapter-to-node mapping is like follows:

| Adapter type | Direction-specific address keys                    |
|----------------|---------------------------------------------------|
| HTTPS          | urlPath                                           |
| HTTP           | httpAddressWithoutQuery                           |
| SFTP           | host                                              |
| JMS            | sender: QueueName_inbound<br>receiver: QueueName_outbound |
| ProcessDirect  | address                                           |
| HCIOData       | address                                           |
| SOAP           | address                                           |

---

## Requirements

- Python 3.x  
- Standard libraries only (e.g.: `os`, `zipfile`, `xml.etree.ElementTree`, `csv`, `re`)  

---

## Author

Created by Manuel Almagro Rivas.
