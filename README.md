# üîç Automatic AS-IS Iflow extractor

This Python script extracts and documents integration flow metadata from zipped SAP Integration Suite packages. It support address resolution for various adapter types and automatically substitutes parameterized values (e.g., `{{c4c_address}}`) using the included `parameters.prop` file.

![Example of the script working and resulting file imported into Excel](https://github.com/malmriv/malmriv.github.io/blob/master/images/ScreenshotASIS.png?raw=true)

The script is able to process entire packages (which are also downloaded as .zip files). Bulk processing is also supported: the script will try to process any .zip files in the same folder.

---

## Features

- Automatically unzips multiple `.zip` files containing iflows  
- Locates and parses the `.iflw` file  
- Extracts metadata for each message flow:  
  - component type (e.g. SOAP, HTTPS, JMS, SFTP...)
  - direction  (Sender/Receiver)
  - name  
  - transport protocol (e.g. HTTPS, SFTP...)  
  - address (e.g. https://mycrm.company.com/api/v1)
- Supports parameter resolution using `parameters.prop`
- Flags whether a parameter was resolved (`parametrized` = true/false)
- Extracts iflow ID and version from MANIFEST.MF file
- Supports direction-aware address keys (e.g., JMS inbound/outbound)  

---

## Usage

In Windows:
1. Place the `.zip` file(s) containing your integration packages in the same directory as the desired Python script and the `RunExtractor.bat` batch file.
2. Run the `.bat` file.
3. The script will run and a comma-separated value (`.csv`) file will appear.
4. The temporary files generated by the script will be deleted afterwards.

More generally, without using the `.bat` file, the script can be run normally from the console. In that case (for example, under a Linux distribution, or in a macOS computer):
1. Place the `.zip` file(s) containing your iflow in the same directory as the script.
2. Navigate to that directory in a terminal (`cd (...)/dir`)
3. Run the script with Python 3 (`python AutomaticASIS.py`).  
4. The script will unzip the package, extract message flow data, resolve parameters, and save the output to `automatic_asis.csv`.  
---

## Output

The script generates a CSV file `automatic_asis.csv` with the following columns:

## example output

| Iflow                                                      | IflowID                                                    | Version | ComponentType | TransportProtocol | Direction | AdapterName | Address                                                                               | Parametrized |
|------------------------------------------------------------|-------------------------------------------------------------|---------|----------------|--------------------|-----------|-------------|----------------------------------------------------------------------------------------|---------------|
| API Test - Calcula letra NIF                               | com.avvale.almagro.api.nifvalidator                        | 1.0.2   | SOAP           | HTTP               | Sender    | SOAP        | /almagro/API/NIF_Validator                                                            | False         |
| HL7 Protocol Converter                                     | HL7-XML_Converter                                          | 1.0.7   | HTTPS          | HTTPS              | Sender    | HTTPS       | /Almagro/HL7/XML2EDI                                                                  | False         |
| HL7 Protocol Converter                                     | HL7-XML_Converter                                          | 1.0.7   | HTTPS          | HTTPS              | Sender    | HTTPS       | /Almagro/HL7/EDI2XML                                                                  | False         |
| Integration Suite API Test                                 | Integration_Suite_API_Test                                 | 1.0.0   | HCIOData       | HTTP               | Receiver  | OData       | https://integration-suite-xxx.it-cpi024.cfapps.eu10-002.hana.ondemand.com/api/v1/| False         |
| Poll SFTP using HTTPS call as trigger                      | Test_-_Poll_SFTP_using_HTTPS_call_as_trigger               | 1.0.5   | HTTPS          | HTTPS              | Sender    | HTTPS       | /almagro/TestCallSFTP                                                                 | False         |
| Poll SFTP using HTTPS call as trigger                      | Test_-_Poll_SFTP_using_HTTPS_call_as_trigger               | 1.0.5   | HTTP           | HTTP               | Receiver  | HTTP        | https://testalmagro.requestcatcher.com/test                                           | False         |
| Poll SFTP using HTTPS call as trigger                      | Test_-_Poll_SFTP_using_HTTPS_call_as_trigger               | 1.0.5   | PollingSFTP    | SFTP               | Sender    | SFTP        |                                                                                        | False         |
| S4HANA Cloud cost center integration with SuccessFactors EC| S4HANA_Cloud_cost_center_integration_with_SuccessFactors_EC| 1.0.0   | HTTPS          | HTTPS              | Sender    | HTTPS       | /test/s4hana/ssff/costcenterreplicate                                                 | False         |
| Test llamadas iterativas con PageToken                     | Test_llamadas_iterativas_con_PageToken                     | 1.0.1   | HTTP           | HTTP               | Receiver  | HTTP        | http://dominio-inventado.com/api                                                      | False         |
| Test llamadas iterativas con PageToken                     | Test_llamadas_iterativas_con_PageToken                     | 1.0.1   | HTTP           | HTTP               | Receiver  | HTTP        | http://dominio-inventado.com/api                                                      | False         |


---

## Parameter substitution

- Parameters are detected in the address using `{{param_name}}` syntax.  
- The script loads parameters from the `parameters.prop` file inside the unzipped folder.  
- If a parameter is found, it replaces it in the address and sets `parametrized` to true.  
- If a parameter is missing, it leaves the placeholder as is but still marks `parametrized` true.  

---

## Supported component types and address keys

The script supports common SAP CPI adapter component types. Each adapter type displays its connectivity-related info in a node with a specific name. The adapter-to-node mapping is like follows:

| Adapter type | Direction-specific address keys                    |
|----------------|---------------------------------------------------|
| HTTPS          | urlPath                                           |
| HTTP           | httpAddressWithoutQuery                           |
| SFTP           | host                                              |
| JMS            | sender: QueueName_inbound<br>receiver: QueueName_outbound |
| ProcessDirect  | address                                           |
| HCIOData       | address                                           |
| SOAP           | address                                           |

---

## Requirements

- Python 3.x  
- Standard libraries only (e.g.: `os`, `zipfile`, `xml.etree.ElementTree`, `csv`, `re`)  

---

## Author

Created by Manuel Almagro Rivas.
